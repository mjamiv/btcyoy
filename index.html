<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Historical Price Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Space Grotesk', sans-serif;
        }
        .mono {
            font-family: 'JetBrains Mono', monospace;
        }
        body {
            background: #000000;
        }
        .text-indigo {
            color: #818cf8;
        }
        .text-magenta {
            color: #e879f9;
        }
        .text-neon-green {
            color: #4ade80;
        }
        .bg-indigo {
            background-color: #818cf8;
        }
        .bg-magenta {
            background-color: #e879f9;
        }
        .border-indigo {
            border-color: #818cf8;
        }
        .border-magenta {
            border-color: #e879f9;
        }
        .glass-card {
            background: rgba(20, 20, 30, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(129, 140, 248, 0.2);
        }
        .glass-card:hover {
            border-color: rgba(232, 121, 249, 0.4);
        }
        .table-row:hover {
            background: rgba(129, 140, 248, 0.1);
        }
        .glow-indigo {
            box-shadow: 0 0 30px rgba(129, 140, 248, 0.3);
        }
        .glow-magenta {
            box-shadow: 0 0 30px rgba(232, 121, 249, 0.3);
        }
        .glow-green {
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.3);
        }
        .gradient-text {
            background: linear-gradient(135deg, #818cf8 0%, #e879f9 50%, #4ade80 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .btn-gradient {
            background: linear-gradient(135deg, #818cf8 0%, #e879f9 100%);
        }
        .btn-gradient:hover {
            background: linear-gradient(135deg, #6366f1 0%, #d946ef 100%);
        }
        .accent-border {
            border-image: linear-gradient(135deg, #818cf8, #e879f9) 1;
        }
        .result-card {
            background: rgba(30, 30, 40, 0.9);
            border: 1px solid rgba(129, 140, 248, 0.3);
        }
        .result-card-highlight {
            background: rgba(30, 30, 40, 0.9);
            border: 2px solid rgba(74, 222, 128, 0.5);
        }
        select {
            font-family: 'Space Grotesk', sans-serif;
        }
    </style>
</head>
<body class="min-h-screen text-gray-100">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <header class="text-center mb-12">
            <div class="flex items-center justify-center gap-4 mb-4">
                <svg class="w-14 h-14 text-magenta" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v2h1c1.1 0 2 .9 2 2v1c0 .55-.22 1.05-.59 1.41l-.41.41.41.41c.37.36.59.86.59 1.41v1c0 1.1-.9 2-2 2h-1v2h-2v-2H9v-6h2V7zm2 4h1v-1h-1v1zm0 4h1v-1h-1v1z"/>
                </svg>
                <h1 class="text-5xl font-bold gradient-text tracking-tight">Bitcoin Price Tracker</h1>
            </div>
            <p class="text-gray-400 text-lg tracking-wide">Track BTC price on <span id="currentDateDisplay" class="text-indigo font-semibold"></span> across all years since genesis</p>
        </header>

        <!-- Current Price Card -->
        <div class="glass-card rounded-2xl p-8 mb-8 glow-indigo transition-all duration-300">
            <div class="flex flex-wrap items-center justify-between gap-6">
                <div>
                    <p class="text-gray-500 text-sm uppercase tracking-widest mb-2">Current BTC Price</p>
                    <p class="text-5xl font-bold text-magenta mono" id="currentPrice">Loading...</p>
                    <p class="text-gray-600 text-sm mt-2" id="lastUpdated"></p>
                </div>
                <div class="flex items-center gap-6">
                    <div class="text-right">
                        <p class="text-gray-500 text-sm uppercase tracking-widest">5-Year CAGR</p>
                        <p class="text-3xl font-bold text-neon-green" id="fiveYearCagrDisplay">--</p>
                    </div>
                    <button onclick="fetchCurrentPrice()" class="btn-gradient text-white px-8 py-4 rounded-xl font-semibold transition-all flex items-center gap-3 hover:scale-105">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        Refresh
                    </button>
                </div>
            </div>
        </div>

        <!-- Purchase Year Comparison -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-all duration-300">
            <h2 class="text-xl font-bold mb-6 flex items-center gap-3 text-gray-100">
                <svg class="w-7 h-7 text-indigo" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                If you invested <span class="text-neon-green">$1</span> in 
                <select id="purchaseYear" class="bg-black border-2 border-indigo rounded-lg px-4 py-2 mx-2 text-magenta font-bold focus:border-magenta focus:outline-none cursor-pointer">
                    <option value="">select year</option>
                </select>, you would have:
            </h2>
            <input type="hidden" id="investmentAmount" value="1">
            
            <!-- Results -->
            <div id="investmentResults" class="hidden mt-4 grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="result-card rounded-xl p-5 text-center">
                    <p class="text-gray-500 text-sm mb-2 uppercase tracking-wide">BTC Price in <span id="purchaseYearLabel"></span></p>
                    <p class="text-2xl font-bold text-indigo mono" id="purchasePrice">--</p>
                </div>
                <div class="result-card rounded-xl p-5 text-center">
                    <p class="text-gray-500 text-sm mb-2 uppercase tracking-wide">BTC Acquired</p>
                    <p class="text-2xl font-bold text-magenta mono" id="btcAcquired">--</p>
                </div>
                <div class="result-card-highlight rounded-xl p-5 text-center glow-green">
                    <p class="text-gray-500 text-sm mb-2 uppercase tracking-wide">Worth Today</p>
                    <p class="text-3xl font-bold text-neon-green mono" id="currentValue">--</p>
                </div>
                <div class="result-card rounded-xl p-5 text-center">
                    <p class="text-gray-500 text-sm mb-2 uppercase tracking-wide">Total Return</p>
                    <p class="text-2xl font-bold mono" id="totalReturn">--</p>
                </div>
            </div>
        </div>

        <!-- Chart Section -->
        <div class="glass-card rounded-2xl p-8 mb-8 transition-all duration-300">
            <h2 class="text-xl font-bold mb-6 flex items-center gap-3 text-gray-100">
                <svg class="w-7 h-7 text-magenta" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"/>
                </svg>
                Price History Chart
            </h2>
            <div class="h-[400px]">
                <canvas id="priceChart"></canvas>
            </div>
        </div>

        <!-- Historical Data Table -->
        <div class="glass-card rounded-2xl p-8 transition-all duration-300">
            <h2 class="text-xl font-bold mb-6 flex items-center gap-3 text-gray-100">
                <svg class="w-7 h-7 text-neon-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                </svg>
                Historical Prices on This Date
            </h2>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-gray-800">
                            <th class="text-left py-4 px-4 text-indigo font-semibold uppercase tracking-wider text-sm">Date</th>
                            <th class="text-right py-4 px-4 text-indigo font-semibold uppercase tracking-wider text-sm">BTC/USD Price</th>
                            <th class="text-right py-4 px-4 text-indigo font-semibold uppercase tracking-wider text-sm">% Return Since Genesis</th>
                            <th class="text-right py-4 px-4 text-indigo font-semibold uppercase tracking-wider text-sm">5-Year CAGR</th>
                            <th class="text-right py-4 px-4 text-indigo font-semibold uppercase tracking-wider text-sm" id="customReturnHeader">% Return (Custom)</th>
                        </tr>
                    </thead>
                    <tbody id="priceTableBody">
                        <!-- Data will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-12 text-gray-600 text-sm">
            <p class="mb-1">Data sources: <span class="text-indigo">CoinGecko API</span> for current price, historical data embedded</p>
            <p>Genesis Block Price: <span class="text-magenta">$0.0001</span> (2009) | CAGR = Compound Annual Growth Rate</p>
        </footer>
    </div>

    <script>
        // Historical BTC prices - comprehensive data for various dates
        const historicalPriceData = {};

        // Complete historical price data by year
        const btcHistoricalByYear = {
            2009: 0.0001,
            2010: 0.06,
            2011: 4.70,
            2012: 5.27,
            2013: 140.00,
            2014: 520.00,
            2015: 230.00,
            2016: 450.00,
            2017: 2500.00,
            2018: 7500.00,
            2019: 5000.00,
            2020: 9500.00,
            2021: 40000.00,
            2022: 30000.00,
            2023: 27000.00,
            2024: 62000.00,
            2025: null
        };

        // More detailed historical data by month
        const monthlyHistoricalData = {
            1: { 2010: 0.00, 2011: 0.30, 2012: 5.00, 2013: 13.50, 2014: 800.00, 2015: 280.00, 2016: 430.00, 2017: 900.00, 2018: 13000.00, 2019: 3500.00, 2020: 8000.00, 2021: 33000.00, 2022: 42000.00, 2023: 17000.00, 2024: 42000.00, 2025: null },
            2: { 2010: 0.00, 2011: 0.80, 2012: 4.50, 2013: 28.00, 2014: 600.00, 2015: 220.00, 2016: 400.00, 2017: 1000.00, 2018: 9000.00, 2019: 3400.00, 2020: 9500.00, 2021: 48000.00, 2022: 38000.00, 2023: 23000.00, 2024: 52000.00, 2025: null },
            3: { 2010: 0.00, 2011: 0.70, 2012: 5.00, 2013: 47.00, 2014: 500.00, 2015: 250.00, 2016: 420.00, 2017: 1100.00, 2018: 8500.00, 2019: 3800.00, 2020: 6500.00, 2021: 58000.00, 2022: 44000.00, 2023: 28000.00, 2024: 68000.00, 2025: null },
            4: { 2010: 0.00, 2011: 0.75, 2012: 5.00, 2013: 100.00, 2014: 450.00, 2015: 240.00, 2016: 450.00, 2017: 1350.00, 2018: 7500.00, 2019: 5000.00, 2020: 7000.00, 2021: 55000.00, 2022: 40000.00, 2023: 29000.00, 2024: 65000.00, 2025: null },
            5: { 2010: 0.00, 2011: 7.00, 2012: 5.00, 2013: 120.00, 2014: 450.00, 2015: 235.00, 2016: 460.00, 2017: 2300.00, 2018: 7400.00, 2019: 7000.00, 2020: 9500.00, 2021: 37000.00, 2022: 30000.00, 2023: 27000.00, 2024: 67000.00, 2025: null },
            6: { 2010: 0.01, 2011: 15.00, 2012: 5.50, 2013: 100.00, 2014: 600.00, 2015: 250.00, 2016: 700.00, 2017: 2500.00, 2018: 6500.00, 2019: 11000.00, 2020: 9200.00, 2021: 35000.00, 2022: 20000.00, 2023: 30000.00, 2024: 65000.00, 2025: null },
            7: { 2010: 0.06, 2011: 14.00, 2012: 7.00, 2013: 95.00, 2014: 620.00, 2015: 280.00, 2016: 660.00, 2017: 2800.00, 2018: 7500.00, 2019: 10000.00, 2020: 11000.00, 2021: 34000.00, 2022: 22000.00, 2023: 29000.00, 2024: 58000.00, 2025: null },
            8: { 2010: 0.07, 2011: 10.00, 2012: 10.00, 2013: 105.00, 2014: 500.00, 2015: 230.00, 2016: 590.00, 2017: 4300.00, 2018: 6400.00, 2019: 10500.00, 2020: 11500.00, 2021: 45000.00, 2022: 21000.00, 2023: 26000.00, 2024: 59000.00, 2025: null },
            9: { 2010: 0.06, 2011: 5.00, 2012: 11.00, 2013: 130.00, 2014: 400.00, 2015: 230.00, 2016: 600.00, 2017: 4200.00, 2018: 6500.00, 2019: 8500.00, 2020: 10800.00, 2021: 43000.00, 2022: 19000.00, 2023: 26500.00, 2024: 60000.00, 2025: null },
            10: { 2010: 0.10, 2011: 3.00, 2012: 11.00, 2013: 140.00, 2014: 350.00, 2015: 270.00, 2016: 650.00, 2017: 5500.00, 2018: 6400.00, 2019: 8200.00, 2020: 13000.00, 2021: 60000.00, 2022: 20000.00, 2023: 34000.00, 2024: 68000.00, 2025: null },
            11: { 2010: 0.20, 2011: 2.50, 2012: 11.00, 2013: 400.00, 2014: 380.00, 2015: 380.00, 2016: 740.00, 2017: 8000.00, 2018: 4500.00, 2019: 7500.00, 2020: 18000.00, 2021: 57000.00, 2022: 16500.00, 2023: 37000.00, 2024: 95000.00, 2025: null },
            12: { 2010: 0.25, 2011: 4.00, 2012: 13.00, 2013: 700.00, 2014: 320.00, 2015: 430.00, 2016: 950.00, 2017: 14000.00, 2018: 3800.00, 2019: 7200.00, 2020: 29000.00, 2021: 47000.00, 2022: 16800.00, 2023: 42000.00, 2024: 98000.00, 2025: null }
        };

        let currentPrice = null;
        let priceChart = null;
        let selectedPurchaseYear = null;

        const today = new Date();
        const currentMonth = today.getMonth() + 1;
        const currentDay = today.getDate();
        const currentYear = today.getFullYear();

        function formatDate(month, day, year) {
            const date = new Date(year, month - 1, day);
            return date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('currentDateDisplay').textContent = 
                today.toLocaleDateString('en-US', { month: 'long', day: 'numeric' });
            
            populateYearDropdown();
            fetchCurrentPrice();
        });

        function populateYearDropdown() {
            const select = document.getElementById('purchaseYear');
            const monthData = monthlyHistoricalData[currentMonth];
            
            for (let year = 2010; year <= currentYear; year++) {
                if (monthData[year] !== undefined && monthData[year] !== null && monthData[year] > 0) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    select.appendChild(option);
                }
            }
        }

        async function fetchCurrentPrice() {
            document.getElementById('currentPrice').textContent = 'Loading...';
            
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');
                const data = await response.json();
                currentPrice = data.bitcoin.usd;
                
                document.getElementById('currentPrice').textContent = '$' + currentPrice.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                
                document.getElementById('lastUpdated').textContent = 'Last updated: ' + new Date().toLocaleTimeString();
                
                // Calculate 5-Year CAGR for display
                const fiveYearsAgoPrice = monthlyHistoricalData[currentMonth][currentYear - 5];
                if (fiveYearsAgoPrice && fiveYearsAgoPrice > 0) {
                    const fiveYearCagr = (Math.pow(currentPrice / fiveYearsAgoPrice, 1/5) - 1) * 100;
                    const cagrElement = document.getElementById('fiveYearCagrDisplay');
                    cagrElement.textContent = (fiveYearCagr >= 0 ? '+' : '') + fiveYearCagr.toLocaleString('en-US', {
                        minimumFractionDigits: 1,
                        maximumFractionDigits: 1
                    }) + '%';
                    cagrElement.className = 'text-3xl font-bold ' + (fiveYearCagr >= 0 ? 'text-neon-green' : 'text-red-400');
                }
                
                monthlyHistoricalData[currentMonth][currentYear] = currentPrice;
                
                updateTable();
                updateChart();
                
            } catch (error) {
                console.error('Error fetching price:', error);
                document.getElementById('currentPrice').textContent = 'Error loading price';
                
                currentPrice = 97000;
                monthlyHistoricalData[currentMonth][currentYear] = currentPrice;
                updateTable();
                updateChart();
            }
        }

        function updateTable() {
            const tbody = document.getElementById('priceTableBody');
            tbody.innerHTML = '';
            
            const monthData = monthlyHistoricalData[currentMonth];
            const years = Object.keys(monthData).sort((a, b) => b - a);
            
            let purchasePrice = null;
            if (selectedPurchaseYear && monthData[selectedPurchaseYear]) {
                purchasePrice = monthData[selectedPurchaseYear];
            }
            
            years.forEach(year => {
                const price = monthData[year];
                if (price === null || price === undefined || price === 0) return;
                
                const row = document.createElement('tr');
                row.className = 'table-row border-b border-gray-800/50 transition-colors';
                
                // Calculate % Return Since Genesis (using 2009 price of $0.0001)
                const genesisPrice = 0.0001;
                let genesisReturn = '--';
                let genesisReturnClass = 'text-gray-600';
                const genesisReturnVal = ((price - genesisPrice) / genesisPrice) * 100;
                genesisReturn = '+' + genesisReturnVal.toLocaleString('en-US', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }) + '%';
                genesisReturnClass = 'text-neon-green';
                
                // Calculate 5-Year CAGR
                const fiveYearsAgo = parseInt(year) - 5;
                const fiveYearsAgoPrice = monthData[fiveYearsAgo];
                let fiveYearCagr = '--';
                let fiveYearCagrClass = 'text-gray-600';
                if (fiveYearsAgoPrice && fiveYearsAgoPrice > 0) {
                    // CAGR = (EndValue / StartValue)^(1/n) - 1
                    const cagr = (Math.pow(price / fiveYearsAgoPrice, 1/5) - 1) * 100;
                    fiveYearCagr = (cagr >= 0 ? '+' : '') + cagr.toLocaleString('en-US', {
                        minimumFractionDigits: 1,
                        maximumFractionDigits: 1
                    }) + '%';
                    fiveYearCagrClass = cagr >= 0 ? 'text-neon-green' : 'text-red-400';
                }
                
                let customReturn = '--';
                let customReturnClass = 'text-gray-600';
                if (purchasePrice && parseInt(year) >= parseInt(selectedPurchaseYear)) {
                    const returnVal = ((price - purchasePrice) / purchasePrice) * 100;
                    customReturn = (returnVal >= 0 ? '+' : '') + returnVal.toLocaleString('en-US', {
                        minimumFractionDigits: 1,
                        maximumFractionDigits: 1
                    }) + '%';
                    customReturnClass = returnVal >= 0 ? 'text-neon-green' : 'text-red-400';
                }
                
                row.innerHTML = `
                    <td class="py-4 px-4">
                        <span class="font-medium text-gray-300">${formatDate(currentMonth, currentDay, year)}</span>
                    </td>
                    <td class="py-4 px-4 text-right mono text-magenta">
                        $${price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                    </td>
                    <td class="py-4 px-4 text-right font-semibold mono ${genesisReturnClass}">
                        ${genesisReturn}
                    </td>
                    <td class="py-4 px-4 text-right font-semibold mono ${fiveYearCagrClass}">
                        ${fiveYearCagr}
                    </td>
                    <td class="py-4 px-4 text-right font-semibold mono ${customReturnClass}">
                        ${customReturn}
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function updateChart() {
            const ctx = document.getElementById('priceChart').getContext('2d');
            const monthData = monthlyHistoricalData[currentMonth];
            
            const years = Object.keys(monthData)
                .filter(year => monthData[year] !== null && monthData[year] > 0)
                .sort((a, b) => a - b);
            
            const labels = years.map(year => formatDate(currentMonth, currentDay, year));
            const prices = years.map(year => monthData[year]);
            
            const backgroundColors = years.map(year => {
                if (parseInt(year) === parseInt(selectedPurchaseYear)) {
                    return 'rgba(232, 121, 249, 1)';
                }
                return 'rgba(129, 140, 248, 0.8)';
            });
            
            const borderColors = years.map(year => {
                if (parseInt(year) === parseInt(selectedPurchaseYear)) {
                    return 'rgba(255, 255, 255, 1)';
                }
                return 'rgba(129, 140, 248, 1)';
            });
            
            const pointRadius = years.map(year => {
                if (parseInt(year) === parseInt(selectedPurchaseYear)) {
                    return 12;
                }
                return 5;
            });

            if (priceChart) {
                priceChart.destroy();
            }

            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(129, 140, 248, 0.3)');
            gradient.addColorStop(0.5, 'rgba(232, 121, 249, 0.1)');
            gradient.addColorStop(1, 'rgba(74, 222, 128, 0.05)');

            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'BTC Price (USD)',
                        data: prices,
                        borderColor: 'rgba(232, 121, 249, 1)',
                        backgroundColor: gradient,
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: backgroundColors,
                        pointBorderColor: borderColors,
                        pointRadius: pointRadius,
                        pointHoverRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#e879f9',
                            bodyColor: '#fff',
                            borderColor: 'rgba(129, 140, 248, 0.5)',
                            borderWidth: 1,
                            padding: 16,
                            displayColors: false,
                            titleFont: {
                                family: 'Space Grotesk',
                                size: 14
                            },
                            bodyFont: {
                                family: 'JetBrains Mono',
                                size: 16
                            },
                            callbacks: {
                                label: function(context) {
                                    return '$' + context.parsed.y.toLocaleString('en-US', {
                                        minimumFractionDigits: 2,
                                        maximumFractionDigits: 2
                                    });
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(129, 140, 248, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(129, 140, 248, 0.7)',
                                maxRotation: 45,
                                minRotation: 45,
                                font: {
                                    family: 'Space Grotesk'
                                }
                            }
                        },
                        y: {
                            type: 'logarithmic',
                            grid: {
                                color: 'rgba(232, 121, 249, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(232, 121, 249, 0.7)',
                                font: {
                                    family: 'JetBrains Mono'
                                },
                                callback: function(value) {
                                    if (value >= 1000) {
                                        return '$' + (value / 1000) + 'K';
                                    }
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }

        function calculateReturns() {
            const yearSelect = document.getElementById('purchaseYear');
            const amountInput = document.getElementById('investmentAmount');
            
            selectedPurchaseYear = yearSelect.value;
            const investmentAmount = parseFloat(amountInput.value);
            
            if (!selectedPurchaseYear || !currentPrice) {
                document.getElementById('investmentResults').classList.add('hidden');
                return;
            }
            
            const monthData = monthlyHistoricalData[currentMonth];
            const purchasePrice = monthData[selectedPurchaseYear];
            
            if (!purchasePrice) {
                document.getElementById('investmentResults').classList.add('hidden');
                return;
            }
            
            const btcAmount = investmentAmount / purchasePrice;
            const currentValue = btcAmount * currentPrice;
            const totalReturn = ((currentValue - investmentAmount) / investmentAmount) * 100;
            
            document.getElementById('purchaseYearLabel').textContent = selectedPurchaseYear;
            
            document.getElementById('purchasePrice').textContent = '$' + purchasePrice.toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 6
            });
            
            document.getElementById('btcAcquired').textContent = btcAmount.toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 8
            }) + ' BTC';
            
            document.getElementById('currentValue').textContent = '$' + currentValue.toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            
            const returnElement = document.getElementById('totalReturn');
            returnElement.textContent = (totalReturn >= 0 ? '+' : '') + totalReturn.toLocaleString('en-US', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }) + '%';
            returnElement.className = 'text-2xl font-bold mono ' + (totalReturn >= 0 ? 'text-neon-green' : 'text-red-400');
            
            document.getElementById('customReturnHeader').textContent = `% Return (Since ${selectedPurchaseYear})`;
            
            document.getElementById('investmentResults').classList.remove('hidden');
            
            updateTable();
            updateChart();
        }

        document.getElementById('purchaseYear').addEventListener('change', calculateReturns);
    </script>
</body>
</html>
